---
import BaseLayout from '../layouts/BaseLayout.astro';

export interface Props {
  title?: string;
  description?: string;
}

const {
  title = 'Provjeri svoje znanje',
  description = 'Testirajte svoje znanje iz svih poglavlja bakteriologije'
} = Astro.props;
---

<BaseLayout title={title} description={description}>

    <div class="min-h-screen bg-gradient-to-br from-slate-800 to-slate-700">
      <!-- Header -->
      <section class="bg-gradient-to-r from-purple-600 to-blue-600 text-white py-16">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 text-center">
          <div class="w-16 h-16 bg-gray-800/20 rounded-full flex items-center justify-center mx-auto mb-6">
            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
          </div>
          <h1 class="text-4xl md:text-5xl font-bold mb-4">Provjeri svoje znanje</h1>
          <p class="text-xl md:text-2xl opacity-90 max-w-3xl mx-auto">
            Testirajte svoje znanje iz svih poglavlja bakteriologije kroz interaktivne kvizove i provjere.
          </p>
        </div>
      </section>

      <!-- Timer Section -->
      <div class="bg-gray-800 border-b border-gray-600 py-4">
        <div class="container mx-auto px-6">
          <div class="text-center">
            <div class="inline-flex items-center bg-gray-700 text-white px-6 py-3 rounded-full border border-blue-500/30">
              <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
              <span class="text-lg font-semibold font-body">Preostalo vrijeme: </span>
              <span id="timer" class="text-2xl font-bold ml-2 text-blue-400">30:00</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Quiz Container -->
      <div class="container mx-auto px-6 py-12">
        <div class="max-w-6xl mx-auto">
          <!-- Quiz Instructions -->
          <div class="bg-gray-800 rounded-xl shadow-lg p-8 mb-8 border border-gray-600">
            <div class="text-center mb-8">
              <div class="w-16 h-16 bg-gradient-to-br from-blue-400 to-blue-600 rounded-full flex items-center justify-center mx-auto mb-4">
                <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
              </div>
              <h2 class="text-2xl font-bold text-white mb-4 font-heading">Upute za test</h2>
              <p class="text-gray-300 text-lg font-body">
                Test sadrži 20 pitanja iz svih poglavlja. Odgovorite na sva pitanja i na kraju vidjet ćete svoj rezultat.
              </p>
            </div>

            <div class="grid md:grid-cols-3 gap-6 text-center">
              <div class="p-4">
                <div class="w-12 h-12 bg-gradient-to-br from-green-400 to-green-600 rounded-full flex items-center justify-center mx-auto mb-3">
                  <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                  </svg>
                </div>
                <h3 class="font-semibold text-white mb-2 font-heading">20 pitanja</h3>
                <p class="text-gray-300 text-sm font-body">Pitanja pokrivaju cijeli sadržaj kursa</p>
              </div>

              <div class="p-4">
                <div class="w-12 h-12 bg-gradient-to-br from-blue-400 to-blue-600 rounded-full flex items-center justify-center mx-auto mb-3">
                  <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                  </svg>
                </div>
                <h3 class="font-semibold text-white mb-2 font-heading">30 minuta</h3>
                <p class="text-gray-300 text-sm font-body">Odgovarajte u vremenskom okviru</p>
              </div>

              <div class="p-4">
                <div class="w-12 h-12 bg-gradient-to-br from-purple-400 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-3">
                  <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                  </svg>
                </div>
                <h3 class="font-semibold text-white mb-2 font-heading">Detaljni rezultat</h3>
                <p class="text-gray-300 text-sm font-body">Vidite svoj postotak uspjeha</p>
              </div>
            </div>
          </div>

          <!-- Progress Bar -->
          <div class="bg-gray-800 rounded-xl shadow-lg p-6 mb-8 border border-gray-600">
            <div class="flex items-center justify-between mb-4">
              <h3 class="text-lg font-semibold text-white font-heading">Napredak kviza</h3>
              <span id="progressText" class="text-sm text-gray-300 font-body">0 / 20 pitanja</span>
            </div>
            <div class="w-full bg-gray-600 rounded-full h-3">
              <div id="progressBar" class="bg-gradient-to-r from-blue-500 to-purple-500 h-3 rounded-full transition-all duration-300" style="width: 0%"></div>
            </div>
          </div>

          <!-- Quiz Form -->
          <div class="bg-gray-800 rounded-xl shadow-lg p-8 border border-gray-600">
            <form id="quizForm" class="space-y-8">
              <!-- Question 1 -->
              <div class="border-b border-gray-600 pb-6">
                <h3 class="text-lg font-semibold text-white mb-4 font-heading">1. Uobičajena sterilizacija hranjivih medija provodi se:</h3>
                <div class="space-y-3">
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q1" value="a" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">a) autoklaviranjem na 121°C/10min</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q1" value="b" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">b) autoklaviranjem na 121°C/20min</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q1" value="c" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">c) autoklaviranjem 100°C/30min</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q1" value="d" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">d) suhom sterilizacijom na 170°C/1h</span>
                  </label>
                </div>
              </div>

              <!-- Question 2 -->
              <div class="border-b border-gray-600 pb-6">
                <h3 class="text-lg font-semibold text-white mb-4 font-heading">2. Uobičajena sterilizacija metalnog laboratorijskog posuđa provodi se:</h3>
                <div class="space-y-3">
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q2" value="a" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">a) autoklaviranjem na 121°C/10min</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q2" value="b" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">b) autoklaviranjem na 121°C/20min</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q2" value="c" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">c) autoklaviranjem 100°C/30min</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q2" value="d" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">d) suhom sterilizacijom na 170°C/1h</span>
                  </label>
                </div>
              </div>

              <!-- Question 3 -->
              <div class="border-b border-gray-600 pb-6">
                <h3 class="text-lg font-semibold text-white mb-4 font-heading">3. Postupkom sterilizacije uništavaju se:</h3>
                <div class="space-y-3">
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q3" value="a" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">a) svi mikroorganizmi</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q3" value="b" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">b) svi mikroorganizmi osim spora</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q3" value="c" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">c) svi mikroorganizmi osim virusa</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q3" value="d" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">d) vegetativni oblici i spore mikroorganizama</span>
                  </label>
                </div>
              </div>

              <!-- Question 4 -->
              <div class="border-b border-gray-600 pb-6">
                <h3 class="text-lg font-semibold text-white mb-4 font-heading">4. Dezifekcija je:</h3>
                <div class="space-y-3">
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q4" value="a" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">a) postupak smanjivanja broja bakterija na živom tkivu</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q4" value="b" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">b) postupak smanjivanja broja bakterija na neživim površinama</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q4" value="c" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">c) oblik sterilizacije</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q4" value="d" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">d) provodi se 70% etanolom</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q4" value="e" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">e) provodi se razrijeđenom HCl</span>
                  </label>
                </div>
              </div>

              <!-- Question 5 -->
              <div class="border-b border-gray-600 pb-6">
                <h3 class="text-lg font-semibold text-white mb-4 font-heading">5. Antisepsa je:</h3>
                <div class="space-y-3">
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q5" value="a" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">a) postupak smanjivanja broja bakterija na živom tkivu</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q5" value="b" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">b) postupak smanjivanja broja bakterija na neživim površinama</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q5" value="c" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">c) oblik sterilizacije</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q5" value="d" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">d) provodi se 70% etanolom</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q5" value="e" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">e) provodi se razrijeđenom HCl</span>
                  </label>
                </div>
              </div>

              <!-- Question 6 -->
              <div class="border-b border-gray-600 pb-6">
                <h3 class="text-lg font-semibold text-white mb-4 font-heading">6. EC X-GLUC agar je:</h3>
                <div class="space-y-3">
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q6" value="a" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">a) selektivna i diferencijalna hranjiva mikrobiološka podloga</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q6" value="b" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">b) neselektivna hranjiva mikrobiološka podloga</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q6" value="c" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">c) čvrsta podloga</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q6" value="d" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">d) tekuća podloga</span>
                  </label>
                </div>
              </div>

              <!-- Question 7 -->
              <div class="border-b border-gray-600 pb-6">
                <h3 class="text-lg font-semibold text-white mb-4 font-heading">7. Hranjivi agar je:</h3>
                <div class="space-y-3">
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q7" value="a" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">a) selektivna i diferencijalna hranjiva mikrobiološka podloga</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q7" value="b" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">b) neselektivna hranjiva mikrobiološka podloga</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q7" value="c" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">c) čvrsta podloga</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q7" value="d" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">d) tekuća podloga</span>
                  </label>
                </div>
              </div>

              <!-- Question 8 -->
              <div class="border-b border-gray-600 pb-6">
                <h3 class="text-lg font-semibold text-white mb-4 font-heading">8. Mac Conkey broth je:</h3>
                <div class="space-y-3">
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q8" value="a" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">a) Čvrsta podloga</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q8" value="b" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">b) Tekuća podloga</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q8" value="c" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">c) Diferencijalna</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q8" value="d" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">d) Selektivna</span>
                  </label>
                </div>
              </div>

              <!-- Question 9 -->
              <div class="border-b border-gray-600 pb-6">
                <h3 class="text-lg font-semibold text-white mb-4 font-heading">9. Slanetz-Bartley agar služi za:</h3>
                <div class="space-y-3">
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q9" value="a" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">a) izolaciju koliformnih bakterija</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q9" value="b" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">b) izolaciju crijevnih enterokoka</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q9" value="c" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">c) potvrdu hidrolize eskulina</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q9" value="d" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">d) uzgoj bakterija iz roda Enterococcus</span>
                  </label>
                </div>
              </div>

              <!-- Question 10 -->
              <div class="border-b border-gray-600 pb-6">
                <h3 class="text-lg font-semibold text-white mb-4 font-heading">10. Koliformne bakterije su:</h3>
                <div class="space-y-3">
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q10" value="a" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">a) Gram negativne bakterije</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q10" value="b" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">b) Gram pozitivne bakterije</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q10" value="c" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">c) kuglaste bakterije (koki)</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q10" value="d" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">d) Štapićaste bakterije</span>
                  </label>
                </div>
              </div>

              <!-- Question 11 -->
              <div class="border-b border-gray-600 pb-6">
                <h3 class="text-lg font-semibold text-white mb-4 font-heading">11. Za Simmonsov citratni agar vrijedi:</h3>
                <div class="space-y-3">
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q11" value="a" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">a) jedini izvor ugljika je laktoza</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q11" value="b" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">b) koristi se u potvrdnom testu kolimetrije</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q11" value="c" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">c) koristi se u završnom testu kolimetrije</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q11" value="d" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">d) plava boja označava pozitivnu reakciju</span>
                  </label>
                </div>
              </div>

              <!-- Question 12 -->
              <div class="border-b border-gray-600 pb-6">
                <h3 class="text-lg font-semibold text-white mb-4 font-heading">12. Koje tvrdnje su točne za bakterije roda <em>Clostridium</em>:</h3>
                <div class="space-y-3">
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q12" value="a" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">a) fakultativno anaerobne</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q12" value="b" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">b) reduciraju sulfite</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q12" value="c" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">c) reduciraju sulfate</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q12" value="d" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">d) sporogene bakterije</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q12" value="e" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">e) produciraju sumporovodik</span>
                  </label>
                </div>
              </div>

              <!-- Question 13 -->
              <div class="border-b border-gray-600 pb-6">
                <h3 class="text-lg font-semibold text-white mb-4 font-heading">13. Za acidorezistentne bakterije vrijedi:</h3>
                <div class="space-y-3">
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q13" value="a" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">a) plave su nakon bojanja po Gramu</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q13" value="b" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">b) boje se po Ziehl-Neelsenu</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q13" value="c" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">c) otporne su na kiseline</span>
                  </label>
                </div>
              </div>

              <!-- Question 14 -->
              <div class="border-b border-gray-600 pb-6">
                <h3 class="text-lg font-semibold text-white mb-4 font-heading">14. <em>Escherichia coli</em>:</h3>
                <div class="space-y-3">
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q14" value="a" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">a) ne raste uz dodatak žučnih soli</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q14" value="b" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">b) potvrđuju se testom hidrolize eskulina</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q14" value="c" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">c) je štapićasta bakterija</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q14" value="d" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">d) je indikator fekalnog zagađenja</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q14" value="e" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">e) je Gram negativna bakterija</span>
                  </label>
                </div>
              </div>

              <!-- Question 15 -->
              <div class="border-b border-gray-600 pb-6">
                <h3 class="text-lg font-semibold text-white mb-4 font-heading">15. Označi temperaturu na kojoj se uzgajaju fekalne koliformne bakterije:</h3>
                <div class="space-y-3">
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q15" value="a" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">a) 22°C</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q15" value="b" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">b) 26°C</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q15" value="c" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">c) 35°C</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q15" value="d" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">d) 42°C</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q15" value="e" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">e) 44,5°C</span>
                  </label>
                </div>
              </div>

              <!-- Question 16 -->
              <div class="border-b border-gray-600 pb-6">
                <h3 class="text-lg font-semibold text-white mb-4 font-heading">16. Na ploču hranjivog agara nacijepili ste 0,1 mL bakterijske suspenzije iz decimalnog razrjeđenja 10000 puta. Nakon inkubacije naraslo je 76 kolonija. CFU je:</h3>
                <div class="space-y-3">
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q16" value="a" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">a) 76 × 10⁶ / mL</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q16" value="b" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">b) 7,6 × 10⁶ / mL</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q16" value="c" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">c) 7,6 × 10⁶ / L</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q16" value="d" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">d) 76 × 10⁴ / mL</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q16" value="e" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">e) 7,6 × 10⁷ / L</span>
                  </label>
                </div>
              </div>

              <!-- Question 17 -->
              <div class="border-b border-gray-600 pb-6">
                <h3 class="text-lg font-semibold text-white mb-4 font-heading">17. Koje tvrdnje su točne za test katalaze?</h3>
                <div class="space-y-3">
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q17" value="a" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">a) može se odrediti je li bakterija striktno aerobna</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q17" value="b" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">b) može se odrediti je li bakterija striktno anaerobna</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q17" value="c" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">c) temelji se na produkciji enzima citokrom oksidaze</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q17" value="d" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">d) u testu dolazi do stvaranja mjehurića kisika</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q17" value="e" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">e) rezultat testa može se odrediti makroskopski</span>
                  </label>
                </div>
              </div>

              <!-- Question 18 -->
              <div class="border-b border-gray-600 pb-6">
                <h3 class="text-lg font-semibold text-white mb-4 font-heading">18. Označi selektivno-diferencijalne podloge za uzgoj bakterija:</h3>
                <div class="space-y-3">
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q18" value="a" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">a) EC X-Gluc agar</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q18" value="b" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">b) Peptonska voda</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q18" value="c" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">c) Hranjivi agar</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q18" value="d" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">d) Slanetz-Bartley agar</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q18" value="e" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">e) Bile aesculin azide agar</span>
                  </label>
                </div>
              </div>

              <!-- Question 19 -->
              <div class="border-b border-gray-600 pb-6">
                <h3 class="text-lg font-semibold text-white mb-4 font-heading">19. Metilen plavo boji:</h3>
                <div class="space-y-3">
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q19" value="a" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">a) Mrtve stanice kvasca bezbojno</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q19" value="b" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">b) Mrtve stanice kvasca plavo</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q19" value="c" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">c) Žive stanice kvasca plavo</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q19" value="d" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">d) Žive stanice kvasca bezbojno</span>
                  </label>
                </div>
              </div>

              <!-- Question 20 -->
              <div class="border-b border-gray-600 pb-6">
                <h3 class="text-lg font-semibold text-white mb-4 font-heading">20. Crijevni enterokoki:</h3>
                <div class="space-y-3">
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q20" value="a" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">a) ne rastu uz dodatak žučnih soli</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q20" value="b" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">b) potvrđuju se testom hidrolize eskulina</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q20" value="c" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">c) su štapićaste bakterije</span>
                  </label>
                  <label class="flex items-center hover:bg-gray-700 p-2 rounded transition-colors duration-200">
                    <input type="checkbox" name="q20" value="d" class="mr-3 text-blue-500 rounded">
                    <span class="text-white font-body">d) su indikatori fekalnog zagađenja</span>
                  </label>
                </div>
              </div>

              <!-- Submit Button -->
              <div class="text-center pt-6">
                <button
                  type="submit"
                  class="bg-gradient-to-r from-blue-600 to-purple-600 text-white px-8 py-4 rounded-xl font-semibold text-lg hover:from-blue-700 hover:to-purple-700 transition-all duration-300 transform hover:scale-105 shadow-lg font-heading"
                  style="outline: none !important; box-shadow: none !important;"
                >
                  Provjeri rezultat
                </button>
              </div>
            </form>

            <!-- Results (Hidden by default) -->
            <div id="quizResults" class="hidden mt-8 space-y-6">
              <!-- Main Results -->
              <div class="p-6 bg-gray-700 rounded-xl border border-gray-600">
              <div class="text-center">
                <div class="w-16 h-16 bg-gradient-to-br from-green-400 to-green-600 rounded-full flex items-center justify-center mx-auto mb-4">
                  <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                  </svg>
                </div>
                <h3 class="text-2xl font-bold text-white mb-2 font-heading">Rezultat testa</h3>
                <p class="text-gray-300 mb-4 font-body">Odgovorili ste na <span id="correctAnswers" class="font-bold text-white">0</span> od <span id="totalQuestions" class="font-bold text-white">20</span> pitanja</p>
                <div class="text-4xl font-bold text-green-400 mb-4">
                  <span id="percentage">0</span>%
                </div>
                <p id="resultMessage" class="text-lg text-white mb-6 font-body"></p>
                <button
                  onclick="resetQuizGlobal()"
                  class="bg-gradient-to-r from-blue-600 to-blue-700 text-white px-6 py-3 rounded-lg font-semibold hover:from-blue-700 hover:to-blue-800 transition-all duration-300 font-heading"
                  style="outline: none !important; box-shadow: none !important;"
                >
                  Pokušaj ponovno
                </button>
              </div>
            </div>
            </div>

            <!-- Achievement Badge -->
            <div id="achievementBadge" class="hidden p-6 bg-gray-700 rounded-xl border border-yellow-500/30">
              <div class="text-center">
                <div id="badgeIcon" class="text-6xl mb-4">🏆</div>
                <h3 id="badgeTitle" class="text-2xl font-bold text-white mb-2 font-heading">Odličje Osvojeno!</h3>
                <p id="badgeDescription" class="text-gray-300 mb-4 font-body">Osvojili ste novo odličje za svoj uspjeh!</p>
              </div>
            </div>

            <!-- Detailed Analytics -->
            <div id="detailedAnalytics" class="hidden p-6 bg-gray-800 rounded-xl shadow-lg border border-gray-600">
              <h3 class="text-xl font-bold text-white mb-6 font-heading">📊 Detaljni pregled rezultata</h3>
              
              <!-- Category Performance -->
              <div class="mb-6">
                <h4 class="text-lg font-semibold text-white mb-4 font-heading">Uspješnost po kategorijama</h4>
                <div id="categoryResults" class="space-y-3"></div>
              </div>

              <!-- Question by Question -->
              <div class="mb-6">
                <h4 class="text-lg font-semibold text-white mb-4 font-heading">Pregled po pitanjima</h4>
                <div id="questionByQuestion" class="space-y-2 max-h-60 overflow-y-auto"></div>
              </div>

              <!-- Time Analysis -->
              <div>
                <h4 class="text-lg font-semibold text-white mb-4 font-heading">Vremenska analiza</h4>
                <div id="timeAnalysis" class="text-gray-300 font-body"></div>
              </div>
            </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Navigation -->
    <div class="bg-gray-800 border-t border-gray-600 py-8">
      <div class="max-w-4xl mx-auto px-6 text-center">
        <div class="flex flex-col sm:flex-row gap-4 justify-center">
          <a
            href="/sadrzaj/"
            class="inline-flex items-center justify-center px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white font-bold rounded-full shadow-lg hover:from-blue-700 hover:to-blue-800 transform hover:-translate-y-1 transition-all duration-300 font-heading"
            style="outline: none !important; box-shadow: none !important;"
          >
            ← Povratak na sadržaj
          </a>
          <a
            href="/"
            class="inline-flex items-center justify-center px-6 py-3 border-2 border-blue-500 text-blue-400 font-bold rounded-full hover:bg-blue-500 hover:text-white transition-all duration-300 font-heading"
            style="outline: none !important; box-shadow: none !important;"
          >
            Početna stranica
          </a>
        </div>
      </div>
    </div>

    <script>
      // Quiz functionality with categories
      const questionCategories: Record<string, string> = {
        q1: 'sterilizacija', q2: 'sterilizacija', q3: 'sterilizacija', q4: 'dezifekcija', q5: 'antisepsa',
        q6: 'podloge', q7: 'podloge', q8: 'podloge', q9: 'bakterije-enterokoki', q10: 'bakterije-koliformne',
        q11: 'testovi', q12: 'bakterije-clostridium', q13: 'bojenje', q14: 'bakterije-ecoli', q15: 'temperatura',
        q16: 'mikrobiologija-kvantitativna', q17: 'testovi', q18: 'podloge', q19: 'bojenje', q20: 'bakterije-enterokoki'
      };

      const correctAnswers: Record<string, string[]> = {
        q1: ['b'], // autoklaviranjem na 121°C/20min
        q2: ['d'], // suhom sterilizacijom na 170°C/1h
        q3: ['a', 'd'], // svi mikroorganizmi, vegetativni oblici i spore mikroorganizama
        q4: ['b', 'd', 'e'], // postupak smanjivanja broja bakterija na neživim površinama, provodi se 70% etanolom, provodi se razrijeđenom HCl
        q5: ['a', 'd'], // postupak smanjivanja broja bakterija na živom tkivu, provodi se 70% etanolom
        q6: ['a', 'c'], // selektivna i diferencijalna hranjiva mikrobiološka podloga, čvrsta podloga
        q7: ['b', 'c'], // neselektivna hranjiva mikrobiološka podloga, čvrsta podloga
        q8: ['b', 'd'], // Tekuća podloga, Selektivna
        q9: ['b', 'd'], // izolaciju crijevnih enterokoka, uzgoj bakterija iz roda Enterococcus
        q10: ['a', 'd'], // Gram negativne bakterije, Štapićaste bakterije
        q11: ['c', 'd'], // koristi se u završnom testu kolimetrije, plava boja označava pozitivnu reakciju
        q12: ['b', 'd', 'e'], // reduciraju sulfite, sporogene bakterije, produciraju sumporovodik
        q13: ['b'], // boje se po Ziehl-Neelsenu
        q14: ['c', 'd', 'e'], // je štapićasta bakterija, je indikator fekalnog zagađenja, je Gram negativna bakterija
        q15: ['e'], // 44,5°C
        q16: ['b'], // 7,6 × 10⁶ / mL
        q17: ['d', 'e'], // u testu dolazi do stvaranja mjehurića kisika, rezultat testa može se odrediti makroskopski
        q18: ['a'], // EC X-Gluc agar
        q19: ['b', 'd'], // Mrtve stanice kvasca plavo, Žive stanice kvasca bezbojno
        q20: ['b', 'd'] // potvrđuju se testom hidrolize eskulina, su indikatori fekalnog zagađenja
      };

      const totalQuestions = Object.keys(correctAnswers).length;
      let timeLeft = 30 * 60; // 30 minutes in seconds
      let timerInterval: NodeJS.Timeout | null = null;
      let answeredQuestions = 0;
      let startTime = Date.now();

      // Achievement system
      const achievements = {
        firstTry: { icon: '🎯', title: 'Prvi pokušaj', description: 'Završili ste svoj prvi kviz!' },
        perfectScore: { icon: '💎', title: 'Perfekcionista', description: 'Postigli ste 100% uspješnost!' },
        speedRunner: { icon: '⚡', title: 'Brzinac', description: 'Završili ste kviz u manje od 15 minuta!' },
        goodScore: { icon: '🥇', title: 'Odličnjak', description: 'Postigli ste preko 90% uspješnost!' },
        improver: { icon: '📈', title: 'Naprednjak', description: 'Poboljšali ste svoj rezultat!' }
      };

      const categoryNames: Record<string, string> = {
        'sterilizacija': 'Sterilizacija',
        'bojenje': 'Bojenje bakterija',
        'podloge': 'Hranjive podloge',
        'mikroskopija': 'Mikroskopija',
        'voda-analiza': 'Analiza vode',
        'bakterije-azotobacter': 'Azotobacter bakterije',
        'bakterije-clostridium': 'Clostridium bakterije',
        'temperatura': 'Temperatura uzgoja',
        'bolesti': 'Bakterijske bolesti',
        'fiksatori-dusika': 'Fiksatori dušika',
        'mikrobiologija-kvantitativna': 'Kvantitativna mikrobiologija',
        'testovi': 'Dijagnostički testovi',
        'mediji': 'Hranjivi mediji'
      };

      // Timer functionality
      function startTimer() {
        timerInterval = setInterval(() => {
          if (timeLeft > 0) {
            timeLeft--;
            updateTimerDisplay();
            
            if (timeLeft <= 300) { // 5 minutes warning
              const timerElement = document.getElementById('timer');
              if (timerElement) timerElement.classList.add('text-red-600');
            }
          } else {
            if (timerInterval) clearInterval(timerInterval);
            submitQuiz();
          }
        }, 1000);
      }

      function updateTimerDisplay() {
        const minutes = Math.floor(timeLeft / 60);
        const seconds = timeLeft % 60;
        const timerElement = document.getElementById('timer');
        if (timerElement) {
          timerElement.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }
      }

      // Progress tracking
      function updateProgress() {
        answeredQuestions = 0;
        Object.keys(correctAnswers).forEach(question => {
          const selectedAnswers = document.querySelectorAll(`input[name="${question}"]:checked`);
          if (selectedAnswers.length > 0) {
            answeredQuestions++;
          }
        });

        const progressPercent = (answeredQuestions / totalQuestions) * 100;
        const progressBar = document.getElementById('progressBar');
        const progressText = document.getElementById('progressText');
        
        if (progressBar) progressBar.style.width = `${progressPercent}%`;
        if (progressText) progressText.textContent = `${answeredQuestions} / ${totalQuestions} pitanja`;
      }

      // Add event listeners to all checkboxes for progress tracking
      document.addEventListener('DOMContentLoaded', function() {
        startTimer();
        
        // Add progress tracking to all checkboxes
        const allCheckboxes = document.querySelectorAll('input[type="checkbox"]');
        allCheckboxes.forEach(checkbox => {
          checkbox.addEventListener('change', updateProgress);
        });
      });

      // Quiz submission
      document.getElementById('quizForm')?.addEventListener('submit', function(e) {
        e.preventDefault();
        submitQuiz();
      });

      function submitQuiz() {
        if (timerInterval) clearInterval(timerInterval);
        
        const endTime = Date.now();
        const timeTaken = Math.round((endTime - startTime) / 1000); // in seconds
        
        let totalScore = 0;
        let totalPossibleScore = 0;
        const questionResults: Record<string, any> = {};
        const categoryScores: Record<string, {correct: number, total: number}> = {};

        // Calculate score for each question and category
        Object.keys(correctAnswers).forEach(question => {
          const selectedAnswers = Array.from(document.querySelectorAll(`input[name="${question}"]:checked`))
            .map(input => (input as HTMLInputElement).value);
          
          const correctCount = correctAnswers[question].length;
          const selectedCorrect = correctAnswers[question].filter(answer => 
            selectedAnswers.includes(answer)
          ).length;
          
          // Check if question is completely correct
          let isCorrect = false;
          let questionScore = 0;
          
          if (selectedCorrect === correctCount && selectedAnswers.length === correctCount) {
            isCorrect = true;
            questionScore = 1; // 1 point per correct question
          }
          
          // Store question result
          questionResults[question] = {
            score: questionScore,
            maxScore: 1,
            isCorrect: isCorrect,
            selected: selectedAnswers,
            correct: correctAnswers[question]
          };
          
          // Update category scores
          const category = questionCategories[question];
          if (!categoryScores[category]) {
            categoryScores[category] = {correct: 0, total: 0};
          }
          categoryScores[category].total += 1;
          categoryScores[category].correct += questionScore;
          
          totalScore += questionScore;
          totalPossibleScore += 1;
        });

        // Calculate percentage
        const percentage = totalPossibleScore > 0 ? Math.round((totalScore / totalPossibleScore) * 100) : 0;

        // Update results
        const correctAnswersElement = document.getElementById('correctAnswers');
        const totalQuestionsElement = document.getElementById('totalQuestions');
        const percentageElement = document.getElementById('percentage');
        const resultMessage = document.getElementById('resultMessage');

        if (correctAnswersElement) correctAnswersElement.textContent = totalScore.toString();
        if (totalQuestionsElement) totalQuestionsElement.textContent = totalPossibleScore.toString();
        if (percentageElement) percentageElement.textContent = percentage.toString();

        // Set result message
        if (resultMessage) {
          if (percentage === 100) {
            resultMessage.innerHTML = '<strong>Odlično!</strong> Savršeno ste odgovorili na sva pitanja! 🏆';
            resultMessage.className = 'text-lg text-green-300 mb-6 font-body';
          } else if (percentage >= 80) {
            resultMessage.innerHTML = '<strong>Vrlo dobro!</strong> Imate odlično znanje iz bakteriologije! 🎯';
            resultMessage.className = 'text-lg text-green-300 mb-6 font-body';
          } else if (percentage >= 60) {
            resultMessage.innerHTML = '<strong>Dobro!</strong> Imate solidno znanje iz bakteriologije. 📚';
            resultMessage.className = 'text-lg text-blue-300 mb-6 font-body';
          } else if (percentage >= 40) {
            resultMessage.innerHTML = '<strong>Prosjecno.</strong> Preporučujemo da ponovno pročitate gradivo. 📖';
            resultMessage.className = 'text-lg text-yellow-300 mb-6 font-body';
          } else {
            resultMessage.innerHTML = '<strong>Potrebno je više učenja.</strong> Vratite se na gradivo i ponovno pročitajte. 🔍';
            resultMessage.className = 'text-lg text-red-300 mb-6 font-body';
          }
        }

        // Show detailed analytics
        showDetailedAnalytics(categoryScores, questionResults, timeTaken);
        
        // Check for achievements
        checkAchievements(percentage, timeTaken);

        // Show results
        const quizResults = document.getElementById('quizResults');
        if (quizResults) {
          quizResults.classList.remove('hidden');
          quizResults.scrollIntoView({ behavior: 'smooth' });
        }
      }

      function showDetailedAnalytics(categoryScores: Record<string, {correct: number, total: number}>, questionResults: Record<string, any>, timeTaken: number) {
        // Category Results
        const categoryResultsDiv = document.getElementById('categoryResults');
        if (categoryResultsDiv) {
          categoryResultsDiv.innerHTML = '';
          Object.entries(categoryScores).forEach(([category, scores]) => {
            const percentage = Math.round((scores.correct / scores.total) * 100);
            const categoryDiv = document.createElement('div');
            categoryDiv.className = 'flex items-center justify-between p-3 bg-gray-50 rounded-lg';
            categoryDiv.innerHTML = `
              <span class="font-medium text-gray-900">${categoryNames[category] || category}</span>
              <div class="flex items-center space-x-2">
                <span class="text-sm text-gray-600">${scores.correct}/${scores.total}</span>
                <span class="font-semibold ${percentage >= 80 ? 'text-green-600' : percentage >= 60 ? 'text-yellow-600' : 'text-red-600'}">${percentage}%</span>
              </div>
            `;
            categoryResultsDiv.appendChild(categoryDiv);
          });
        }

        // Question by Question
        const questionByQuestionDiv = document.getElementById('questionByQuestion');
        if (questionByQuestionDiv) {
          questionByQuestionDiv.innerHTML = '';
          Object.entries(questionResults).forEach(([question, result]) => {
            const questionNum = question.replace('q', '');
            const questionDiv = document.createElement('div');
            questionDiv.className = `flex items-center justify-between p-2 rounded ${result.isCorrect ? 'bg-green-50' : 'bg-red-50'}`;
            questionDiv.innerHTML = `
              <span class="text-sm">Pitanje ${questionNum}</span>
              <span class="text-sm font-medium ${result.isCorrect ? 'text-green-600' : 'text-red-600'}">
                ${result.isCorrect ? '✓ Točno' : '✗ Netočno'} (${result.score}/${result.maxScore})
              </span>
            `;
            questionByQuestionDiv.appendChild(questionDiv);
          });
        }

        // Time Analysis
        const timeAnalysisDiv = document.getElementById('timeAnalysis');
        if (timeAnalysisDiv) {
          const minutes = Math.floor(timeTaken / 60);
          const seconds = timeTaken % 60;
          const avgTimePerQuestion = Math.round(timeTaken / totalQuestions);
          timeAnalysisDiv.innerHTML = `
            <p><strong>Ukupno vrijeme:</strong> ${minutes}m ${seconds}s</p>
            <p><strong>Prosječno vrijeme po pitanju:</strong> ${avgTimePerQuestion}s</p>
            <p><strong>Preostalo vrijeme:</strong> ${Math.floor(timeLeft / 60)}m ${timeLeft % 60}s</p>
          `;
        }

        // Show analytics
        const detailedAnalytics = document.getElementById('detailedAnalytics');
        if (detailedAnalytics) {
          detailedAnalytics.classList.remove('hidden');
        }
      }

      function checkAchievements(percentage: number, timeTaken: number) {
        let earnedAchievement = null;

        // Check for achievements
        if (percentage === 100) {
          earnedAchievement = achievements.perfectScore;
        } else if (percentage >= 90) {
          earnedAchievement = achievements.goodScore;
        } else if (timeTaken < 15 * 60) { // Less than 15 minutes
          earnedAchievement = achievements.speedRunner;
        } else {
          // Check if this is first try
          const hasTriedBefore = localStorage.getItem('quizAttempted');
          if (!hasTriedBefore) {
            localStorage.setItem('quizAttempted', 'true');
            earnedAchievement = achievements.firstTry;
          }
        }

        if (earnedAchievement) {
          showAchievement(earnedAchievement);
        }
      }

      function showAchievement(achievement: any) {
        const badgeIcon = document.getElementById('badgeIcon');
        const badgeTitle = document.getElementById('badgeTitle');
        const badgeDescription = document.getElementById('badgeDescription');
        const achievementBadge = document.getElementById('achievementBadge');

        if (badgeIcon) badgeIcon.textContent = achievement.icon;
        if (badgeTitle) badgeTitle.textContent = achievement.title;
        if (badgeDescription) badgeDescription.textContent = achievement.description;
        if (achievementBadge) achievementBadge.classList.remove('hidden');
      }

      function resetQuizGlobal() {
        // Reset form
        const form = document.getElementById('quizForm') as HTMLFormElement;
        if (form) form.reset();
        
        // Hide results
        const quizResults = document.getElementById('quizResults');
        if (quizResults) quizResults.classList.add('hidden');
        
        // Reset all other elements
        const achievementBadge = document.getElementById('achievementBadge');
        if (achievementBadge) achievementBadge.classList.add('hidden');
        
        const detailedAnalytics = document.getElementById('detailedAnalytics');
        if (detailedAnalytics) detailedAnalytics.classList.add('hidden');
        
        // Reset progress bar
        const progressBar = document.getElementById('progressBar');
        if (progressBar) progressBar.style.width = '0%';
        
        // Reset progress text
        const progressText = document.getElementById('progressText');
        if (progressText) progressText.textContent = '0 / 20 pitanja';
        
        // Scroll to top
        window.scrollTo({ top: 0, behavior: 'smooth' });
      }
      
      // Make function globally accessible
      (window as any).resetQuizGlobal = resetQuizGlobal;

      // Mobile menu functionality
      document.addEventListener('DOMContentLoaded', function() {
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const mobileMenu = document.getElementById('mobile-menu');
        
        if (mobileMenuButton && mobileMenu) {
          mobileMenuButton.addEventListener('click', function() {
            const isExpanded = this.getAttribute('aria-expanded') === 'true';
            this.setAttribute('aria-expanded', (!isExpanded).toString());
            mobileMenu.classList.toggle('hidden');
          });
        }
      });
    </script>

</BaseLayout>
