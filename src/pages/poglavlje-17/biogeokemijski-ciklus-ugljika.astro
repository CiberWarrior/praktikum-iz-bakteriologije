---
import SubPageLayoutWithBase from "../../components/SubPageLayoutWithBase.astro";

export interface Props {
  title?: string;
  description?: string;
}

const { 
  title = 'Biogeokemijski ciklus ugljika',
  description = 'Biogeokemijski ciklus ugljika u prirodi i uloga saprofitskih bakterija u kruženju ugljika kroz ekosustav.'
} = Astro.props;
---

<SubPageLayoutWithBase chapterNumber={17} 
  title={title} 
  description={description}
  chapterNumber={17}
  primaryColor="lime"
  breadcrumbPath={[
    { name: 'Poglavlje 17', url: '/poglavlje-17/' },
    { name: 'Biogeokemijski ciklus ugljika', url: '/poglavlje-17/biogeokemijski-ciklus-ugljika/' }
  ]}
>

  <!-- Main Content with Sidebar -->
  <div class="flex max-w-7xl mx-auto">
    
    <!-- Table of Contents Sidebar -->
    <aside class="hidden lg:block w-64 p-6 bg-gradient-to-b from-gray-50 to-gray-100 border-r border-gray-200 sticky top-0 h-screen overflow-y-auto shadow-lg">
      <div class="mb-6">
        <div class="flex items-center mb-6">
          <div class="w-8 h-8 bg-lime-600 rounded-lg flex items-center justify-center mr-3">
            <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 012 2"></path>
            </svg>
          </div>
          <h3 class="text-xl font-bold text-gray-900">Sadržaj stranice</h3>
        </div>
        
        <!-- Bookmark Button -->
        <button id="bookmark-btn" class="flex items-center space-x-3 text-sm text-gray-600 hover:text-lime-600 transition-all duration-300 mb-6 p-3 rounded-lg hover:bg-lime-50 w-full">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"></path>
          </svg>
          <span id="bookmark-text" class="font-medium">Označiti kao bookmark</span>
        </button>
        
        <!-- Table of Contents -->
        <nav class="space-y-1">
          <div class="text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2">Sadržaj stranice</div>
          <a href="#ciklus-ugljika" class="toc-link group flex items-center text-sm text-gray-600 hover:text-lime-600 transition-all duration-300 py-2 px-3 rounded-lg hover:bg-lime-50" data-target="ciklus-ugljika">
            <span class="w-2 h-2 bg-blue-400 rounded-full mr-3 transition-all duration-300"></span>
            Ciklus ugljika
          </a>
          <a href="#ugljikohidrati" class="toc-link group flex items-center text-sm text-gray-600 hover:text-lime-600 transition-all duration-300 py-2 px-3 rounded-lg hover:bg-lime-50" data-target="ugljikohidrati">
            <span class="w-2 h-2 bg-orange-400 rounded-full mr-3 transition-all duration-300"></span>
            Ugljikohidrati
          </a>
          <a href="#oligokarbofilne-bakterije" class="toc-link group flex items-center text-sm text-gray-600 hover:text-lime-600 transition-all duration-300 py-2 px-3 rounded-lg hover:bg-lime-50" data-target="oligokarbofilne-bakterije">
            <span class="w-2 h-2 bg-green-400 rounded-full mr-3 transition-all duration-300"></span>
            Oligokarbofilne i polikarbofilne bakterije
          </a>
        </nav>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 px-6 py-8">
      <div class="max-w-4xl mx-auto">
        <div class="prose prose-lg max-w-none">
          
          <!-- Content Blocks -->
          <div class="space-y-8">
            
            <!-- Ciklus ugljika -->
            <div id="ciklus-ugljika" class="bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-6 shadow-lg border border-blue-200">
              <div class="flex items-center mb-4">
                <span class="text-3xl mr-4">🌱</span>
                <h3 class="text-2xl font-bold text-blue-900">Ciklus ugljika u prirodi</h3>
              </div>
              <div class="space-y-4">
                <p class="text-gray-700 leading-relaxed">
                  U procesu fotosinteze biljaka CO₂ iz atmosfere ugrađuje se u organske spojeve autotrofnih organizama (biljke) i u tom obliku označujemo ga kao organski ugljik. Organski spojevi ugljika u biljkama osnovica su za život svih heterotrofnih organizama na Zemlji, tj. životinja i čovjeka.
                </p>
                <p class="text-gray-700 leading-relaxed">
                  Nakon uginuća biljaka i životinja organski ugljik razgrađuju heterotrofne (saprofitske) bakterije te ga procesima aerobnog i anaerobnog disanja vraćaju u obliku CO₂ u atmosferu.
                </p>
                <div class="bg-blue-100 border border-blue-300 rounded-lg p-4">
                  <p class="text-blue-800 font-semibold">
                    💡 Ako je heterotrofnim bakterijama za razgradnju organskog ugljika dostupan kisik, CO₂ će se direktno oslobađati natrag u atmosferu.
                  </p>
                </div>
                <p class="text-gray-700 leading-relaxed">
                  U anaerobnim uvjetima organski ugljik bude preveden do metana (CH₄). Kad u okolišu s metanom bude dostupan kisik, bakterije će oksidirati metan do CO₂ ili CO₂ i organskih spojeva ugljika.
                </p>
                <p class="text-gray-700 leading-relaxed">
                  Organski se ugljik može nagomilavati u okolišu i tijekom geološkog razdoblja nastaju treset, smeđi ugljen, antracit, nafta (fosilna goriva). Ugljik iz fosilnih goriva ne može biološkim putem biti vraćen u atmosferu, nego se oslobađa izgaranjem fosilnih goriva.
                </p>
                
                <figure class="image-figure bg-white rounded-lg p-4 shadow-sm mt-6">
                  <img src="/Images/slika70.jpg" alt="Ciklus kruženja ugljika u prirodi" class="w-4/5 h-auto rounded-lg mx-auto" />
                  <figcaption class="mt-4 text-center">
                    <span class="inline-block bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium">Slika 70</span>
                    <span class="block mt-2 text-gray-700">Ciklus kruženja ugljika u prirodi</span>
                  </figcaption>
                </figure>
              </div>
            </div>

            <!-- Ugljikohidrati -->
            <div id="ugljikohidrati" class="bg-gradient-to-br from-orange-50 to-amber-50 rounded-xl p-6 shadow-lg border border-orange-200">
              <div class="flex items-center mb-4">
                <span class="text-3xl mr-4">🧬</span>
                <h3 class="text-2xl font-bold text-orange-900">Ugljikohidrati</h3>
              </div>
              <p class="text-gray-700 leading-relaxed mb-4">
                Ugljikohidrati, kao najpoznatiji i najprisutniji organski spojevi ugljika vrlo su rašireni spojevi na Zemlji, a izgrađeni su od molekula ugljika, vodika i kisika.
              </p>
              <div class="grid md:grid-cols-3 gap-4 mt-4">
                <div class="bg-orange-100 rounded-lg p-4 border-l-4 border-orange-500">
                  <div class="flex items-center mb-2">
                    <span class="bg-orange-500 text-white text-sm font-bold px-2 py-1 rounded">Polisaharidi</span>
                  </div>
                  <p class="text-orange-800 text-sm">Kompleksni ugljikohidrati - najčešći u prirodi</p>
                </div>
                <div class="bg-amber-100 rounded-lg p-4 border-l-4 border-amber-500">
                  <div class="flex items-center mb-2">
                    <span class="bg-amber-500 text-white text-sm font-bold px-2 py-1 rounded">Disaharidi</span>
                  </div>
                  <p class="text-amber-800 text-sm">Jednostavniji ugljikohidrati</p>
                </div>
                <div class="bg-yellow-100 rounded-lg p-4 border-l-4 border-yellow-500">
                  <div class="flex items-center mb-2">
                    <span class="bg-yellow-500 text-white text-sm font-bold px-2 py-1 rounded">Monosaharidi</span>
                  </div>
                  <p class="text-yellow-800 text-sm">Najjednostavniji (glukoza)</p>
                </div>
              </div>
              <div class="bg-orange-100 border border-orange-300 rounded-lg p-4 mt-4">
                <p class="text-orange-800 font-semibold">
                  🔬 Najveći broj bakterija može direktno iskorištavati monosaharide (glukoza), a kompleksne ugljikohidrate mogu iskorištavati tek kada ih druge vrste bakterija razgrade do monosaharida.
                </p>
              </div>
            </div>

            <!-- Oligokarbofilne i polikarbofilne bakterije -->
            <div id="oligokarbofilne-bakterije" class="bg-gradient-to-br from-green-50 to-emerald-50 rounded-xl p-6 shadow-lg border border-green-200">
              <div class="flex items-center mb-4">
                <span class="text-3xl mr-4">🦠</span>
                <h3 class="text-2xl font-bold text-green-900">Oligokarbofilne i polikarbofilne bakterije</h3>
              </div>
              <div class="space-y-4">
                <div class="grid md:grid-cols-2 gap-6">
                  <!-- Oligokarbofilne -->
                  <div class="bg-green-100 rounded-lg p-4 border border-green-300">
                    <h4 class="text-green-900 font-semibold mb-3">Oligokarbofilne (oligotrofne) bakterije</h4>
                    <ul class="text-green-800 space-y-2 text-sm">
                      <li class="flex items-start"><span class="w-2 h-2 bg-green-600 rounded-full mr-3 mt-2"></span>Prirodno žive u čistim vodama</li>
                      <li class="flex items-start"><span class="w-2 h-2 bg-green-600 rounded-full mr-3 mt-2"></span>Ne rastu na podlogama s visokim koncentracijama ugljika</li>
                      <li class="flex items-start"><span class="w-2 h-2 bg-green-600 rounded-full mr-3 mt-2"></span>Potrebne su podloge s niskim koncentracijama organske tvari (~0,1%)</li>
                      <li class="flex items-start"><span class="w-2 h-2 bg-green-600 rounded-full mr-3 mt-2"></span>Uzgoj: hranjivi agar 10x razrijeđen</li>
                    </ul>
                  </div>
                  
                  <!-- Polikarbofilne -->
                  <div class="bg-emerald-100 rounded-lg p-4 border border-emerald-300">
                    <h4 class="text-emerald-900 font-semibold mb-3">Polikarbofilne bakterije</h4>
                    <ul class="text-emerald-800 space-y-2 text-sm">
                      <li class="flex items-start"><span class="w-2 h-2 bg-emerald-600 rounded-full mr-3 mt-2"></span>Rastu na standardnim hranjivim podlogama</li>
                      <li class="flex items-start"><span class="w-2 h-2 bg-emerald-600 rounded-full mr-3 mt-2"></span>Toleriraju visoke koncentracije organske tvari</li>
                      <li class="flex items-start"><span class="w-2 h-2 bg-emerald-600 rounded-full mr-3 mt-2"></span>Brži rast i bujan razvoj</li>
                      <li class="flex items-start"><span class="w-2 h-2 bg-emerald-600 rounded-full mr-3 mt-2"></span>Uzgoj: standardni hranjivi agar</li>
                    </ul>
                  </div>
                </div>
                
                <div class="bg-green-100 border border-green-300 rounded-lg p-4">
                  <p class="text-green-800 font-semibold mb-2">
                    ⚗️ Uvjeti uzgoja za oba tipa:
                  </p>
                  <p class="text-green-700 text-sm">
                    Temperatura: 22°C, Vrijeme inkubacije: 72 h
                  </p>
                </div>
                
                <p class="text-gray-700 leading-relaxed text-sm">
                  Oligotrofi ne rastu bujno i brzo na originalnom hranjivom agaru jer su inhibirani visokim koncentracijama organske tvari alohtonog porijekla, za koje još nemaju razvijene enzimske sustave. Gotovo većina oligotrofnih bakterija sposobna je rasti nakon prilagodbe na povećane koncentracije organskih tvari, na bogatim podlogama (prilagodba na supstrat).
                </p>
              </div>
            </div>

          </div>

        </div>
      </div>
    </main>
  </div>

  <!-- Mobile TOC Toggle -->
  <button id="mobile-toc-toggle" class="lg:hidden fixed bottom-4 right-4 bg-lime-600 text-white p-3 rounded-full shadow-lg z-50">
    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7"></path>
    </svg>
  </button>

  <!-- Mobile TOC Overlay -->
  <div id="mobile-toc-overlay" class="lg:hidden fixed inset-0 bg-black bg-opacity-50 z-40 hidden">
    <div class="fixed right-0 top-0 h-full w-80 bg-white shadow-xl transform translate-x-full transition-transform duration-300" id="mobile-toc-panel">
      <div class="p-6">
        <div class="flex justify-between items-center mb-6">
          <h3 class="text-lg font-semibold text-gray-900">Brza navigacija</h3>
          <button id="mobile-toc-close" class="text-gray-500 hover:text-gray-700">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </button>
        </div>
        
        <!-- Bookmark Button -->
        <button id="mobile-bookmark-btn" class="flex items-center space-x-2 text-sm text-gray-600 hover:text-lime-600 transition-colors duration-200 mb-4 w-full">
          <svg id="mobile-bookmark-icon" class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"></path>
          </svg>
          <span id="mobile-bookmark-text">Označiti kao bookmark</span>
        </button>
        
        <!-- Navigation Links -->
        <nav class="space-y-2">
          <a href="/poglavlje-17/" class="mobile-toc-link block text-sm text-gray-600 hover:text-lime-600 transition-colors duration-200 py-2 border-l-2 border-transparent hover:border-lime-600 pl-3">
            Pregled poglavlja
          </a>
          <a href="/sadrzaj/" class="mobile-toc-link block text-sm text-gray-600 hover:text-lime-600 transition-colors duration-200 py-2 border-l-2 border-transparent hover:border-lime-600 pl-3">
            Svi sadržaji
          </a>
        </nav>
      </div>
    </div>
  </div>

  <!-- Navigacijski gumbovi -->
  <div class="flex justify-between mt-16 mb-8 max-w-4xl mx-auto px-4 sm:px-6">
    <!-- Prethodna stranica -->
    <a
      href="/poglavlje-17/"
      class="inline-flex items-center justify-center px-8 py-4 bg-gradient-to-r from-purple-600 to-blue-600 text-white font-semibold rounded-full shadow-lg hover:shadow-xl transition-all duration-300 no-underline transform hover:-translate-y-1"
      aria-label="Prijeđi na pregled poglavlja 17"
    >
      ←
      <span class="text-lg">Pregled poglavlja 17</span>
    </a>
    
    <!-- Iduća stranica -->
    <a
      href="/poglavlje-17/amiloliticke-bakterije/"
      class="inline-flex items-center justify-center px-8 py-4 bg-gradient-to-r from-purple-600 to-blue-600 text-white font-semibold rounded-full shadow-lg hover:shadow-xl transition-all duration-300 no-underline transform hover:-translate-y-1"
      aria-label="Prijeđi na amilolitičke bakterije"
    >
      <span class="text-lg">Amilolitičke bakterije</span>
      →
    </a>
  </div>

  <!-- CSS Styles for Active State -->
  <style>
    .toc-link.active {
      @apply text-lime-600 bg-lime-50 font-semibold;
    }
    
    .toc-link.active span {
      @apply w-3 h-3 scale-125;
    }
  </style>

  <!-- JavaScript -->
  <script>
    // Bookmark functionality
    function initBookmarks() {
      const bookmarkKey = 'bookmark-biogeokemijski-ciklus-ugljika';
      const bookmarkBtn = document.getElementById('bookmark-btn');
      const bookmarkText = document.getElementById('bookmark-text');
      const mobileBookmarkBtn = document.getElementById('mobile-bookmark-btn');
      const mobileBookmarkText = document.getElementById('mobile-bookmark-text');
      
      // Check if bookmarked
      const isBookmarked = localStorage.getItem(bookmarkKey) === 'true';
      updateBookmarkUI(isBookmarked);
      
      function updateBookmarkUI(bookmarked: boolean) {
        const text = bookmarked ? 'Ukloniti bookmark' : 'Označiti kao bookmark';
        
        if (bookmarkText) bookmarkText.textContent = text;
        if (mobileBookmarkText) mobileBookmarkText.textContent = text;
      }
      
      function toggleBookmark() {
        const currentlyBookmarked = localStorage.getItem(bookmarkKey) === 'true';
        const newBookmarkState = !currentlyBookmarked;
        localStorage.setItem(bookmarkKey, newBookmarkState.toString());
        updateBookmarkUI(newBookmarkState);
      }
      
      if (bookmarkBtn) bookmarkBtn.addEventListener('click', toggleBookmark);
      if (mobileBookmarkBtn) mobileBookmarkBtn.addEventListener('click', toggleBookmark);
    }

    // Mobile TOC
    function initMobileTOC() {
      const toggleBtn = document.getElementById('mobile-toc-toggle');
      const overlay = document.getElementById('mobile-toc-overlay');
      const panel = document.getElementById('mobile-toc-panel');
      const closeBtn = document.getElementById('mobile-toc-close');
      const tocLinks = document.querySelectorAll('.mobile-toc-link');
      
      function openTOC() {
        if (overlay && panel) {
          overlay.classList.remove('hidden');
          setTimeout(() => {
            panel.classList.remove('translate-x-full');
          }, 10);
        }
      }
      
      function closeTOC() {
        if (panel && overlay) {
          panel.classList.add('translate-x-full');
          setTimeout(() => {
            overlay.classList.add('hidden');
          }, 300);
        }
      }
      
      if (toggleBtn) toggleBtn.addEventListener('click', openTOC);
      if (closeBtn) closeBtn.addEventListener('click', closeTOC);
      if (overlay) {
        overlay.addEventListener('click', (e) => {
          if (e.target === overlay) closeTOC();
        });
      }
      
      // Close TOC when clicking on a link
      tocLinks.forEach(link => {
        link.addEventListener('click', closeTOC);
      });
    }

    // Scroll Spy for TOC
    function initScrollSpy() {
      const sections = document.querySelectorAll('[id]');
      const tocLinks = document.querySelectorAll('.toc-link');
      
      function updateActiveLink() {
        let currentSection = '';
        
        sections.forEach(section => {
          const rect = section.getBoundingClientRect();
          if (rect.top <= 100 && rect.bottom >= 100) {
            currentSection = section.id;
          }
        });
        
        // Remove active class from all links
        tocLinks.forEach(link => {
          link.classList.remove('active');
        });
        
        // Add active class to current section link
        if (currentSection) {
          const activeLink = document.querySelector(`[data-target="${currentSection}"]`);
          if (activeLink) {
            activeLink.classList.add('active');
          }
        }
      }
      
      // Listen for scroll events
      window.addEventListener('scroll', updateActiveLink);
      
      // Initial check
      updateActiveLink();
    }

    // Initialize everything
    document.addEventListener('DOMContentLoaded', () => {
      initBookmarks();
      initMobileTOC();
      initScrollSpy();
    });
  </script>

</SubPageLayoutWithBase>