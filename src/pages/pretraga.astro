---
import '../styles/tailwind.css';

export interface Props {
  title?: string;
  description?: string;
}

const {
  title = 'Pretraga - Pronaƒëite sve ≈°to trebate',
  description = 'Pretra≈æite kroz sav sadr≈æaj ud≈æbenika - poglavlja, vje≈æbe, kvizove i pojmove'
} = Astro.props;

// Indexiran sadr≈æaj za pretragu
const searchIndex = {
  poglavlja: [
    {
      id: 'poglavlje-1',
      naslov: 'Uvod u bakteriolo≈°ki praktikum',
      sadrzaj: 'Aseptika, sterilizacija, sigurnost rada, osnovne tehnike bakteriolo≈°kog praktikuma',
      tip: 'poglavlje',
      url: '/poglavlje-1/',
      tags: ['aseptika', 'sterilizacija', 'sigurnost', 'osnove']
    },
    {
      id: 'poglavlje-2', 
      naslov: 'Bojenje bakterija',
      sadrzaj: 'Gram bojenje, bojenje endospora, kapsule, flagela, negativno bojenje, fiksiranje',
      tip: 'poglavlje',
      url: '/poglavlje-2/',
      tags: ['gram', 'bojenje', 'endospore', 'kapsule', 'flagele']
    },
    {
      id: 'poglavlje-3',
      naslov: 'Hranjive podloge',
      sadrzaj: 'Priprava podloga, sterilizacija, agar, selektivne i diferencijalne podloge',
      tip: 'poglavlje', 
      url: '/poglavlje-3/',
      tags: ['podloge', 'agar', 'selektivne', 'diferencijalne', 'priprava']
    },
    {
      id: 'poglavlje-4',
      naslov: 'Nacjepljivanje bakterija',
      sadrzaj: 'Tehnike nacjepljivanja, sterilno nacjepljivanje, aseptiƒçni rad, kulture',
      tip: 'poglavlje',
      url: '/poglavlje-4/',
      tags: ['nacjepljivanje', 'kulture', 'aseptika', 'tehnike']
    },
    {
      id: 'poglavlje-5',
      naslov: 'Kvantitativna mikrobiologija',
      sadrzaj: 'Brojanje bakterija, decimalno razrjeƒëenje, CFU, titar, statistika',
      tip: 'poglavlje',
      url: '/poglavlje-5/',
      tags: ['brojanje', 'cfu', 'titar', 'kvantitativno', 'statistika']
    },
    {
      id: 'poglavlje-6',
      naslov: 'Biokemijski testovi',
      sadrzaj: 'Indol test, MR-VP test, katalaza, oksidaza, identifikacija bakterija',
      tip: 'poglavlje',
      url: '/poglavlje-6/',
      tags: ['biokemijski', 'testovi', 'indol', 'katalaza', 'identifikacija']
    },
    {
      id: 'poglavlje-7',
      naslov: 'Escherichia coli',
      sadrzaj: 'E. coli, EC-X-GLUC agar, Endo agar, MacConkey, identifikacija, analiza vode',
      tip: 'poglavlje',
      url: '/poglavlje-7/',
      tags: ['e.coli', 'escherichia', 'endo', 'macconkey', 'voda']
    },
    {
      id: 'poglavlje-8',
      naslov: 'Enterokoki',
      sadrzaj: 'Crijevni enterokoki, gram pozitivne bakterije, analiza vode, identifikacija',
      tip: 'poglavlje',
      url: '/poglavlje-8/',
      tags: ['enterokoki', 'gram pozitivne', 'voda', 'crijevni']
    },
    {
      id: 'poglavlje-9',
      naslov: 'Saprofitske bakterije',
      sadrzaj: 'Ukupne saprofitske bakterije, analiza vode, brojanje, hranjivi agar',
      tip: 'poglavlje',
      url: '/poglavlje-9/',
      tags: ['saprofitske', 'voda', 'brojanje', 'hranjivi agar']
    },
    {
      id: 'poglavlje-10',
      naslov: 'Koliformne bakterije',
      sadrzaj: 'Koliformi, analiza vode, laktozni pozitivni, identifikacija',
      tip: 'poglavlje',
      url: '/poglavlje-10/',
      tags: ['koliformi', 'laktoza', 'voda', 'analiza']
    },
    {
      id: 'poglavlje-11',
      naslov: 'Staphylococcus aureus',
      sadrzaj: 'Stafilokoki, katalaza test, mannitol, identifikacija, patogeni',
      tip: 'poglavlje',
      url: '/poglavlje-11/',
      tags: ['staphylococcus', 'katalaza', 'mannitol', 'patogeni']
    },
    {
      id: 'poglavlje-12',
      naslov: 'Pseudomonas aeruginosa',
      sadrzaj: 'Pseudomonas, oksidaza test, pigmenti, gram negativne, identifikacija',
      tip: 'poglavlje',
      url: '/poglavlje-12/',
      tags: ['pseudomonas', 'oksidaza', 'pigmenti', 'gram negativne']
    },
    {
      id: 'poglavlje-13',
      naslov: 'Sulfit-reducirajuƒáe klostridije',
      sadrzaj: 'Clostridium, anaerobne bakterije, endospore, SPS agar, sulfit redukcija',
      tip: 'poglavlje',
      url: '/poglavlje-13/',
      tags: ['clostridium', 'anaerobne', 'endospore', 'sps', 'sulfit']
    },
    {
      id: 'poglavlje-14',
      naslov: 'Analiza tla',
      sadrzaj: 'Mikrobiologija tla, uzorkovanje, analiza, bakterije u tlu',
      tip: 'poglavlje',
      url: '/poglavlje-14/',
      tags: ['tlo', 'uzorkovanje', 'analiza', 'mikrobiologija']
    },
    {
      id: 'poglavlje-15',
      naslov: 'Azotobacter',
      sadrzaj: 'Fiksatori du≈°ika, Azotobacter, Ashby agar, kapsule, nesimbiotski',
      tip: 'poglavlje',
      url: '/poglavlje-15/',
      tags: ['azotobacter', 'du≈°ik', 'ashby', 'kapsule', 'fiksatori']
    },
    {
      id: 'poglavlje-16',
      naslov: 'Rhizobium',
      sadrzaj: 'Simbiotski fiksatori du≈°ika, Rhizobium, korijenski ƒçvoriƒái, leguminoze',
      tip: 'poglavlje',
      url: '/poglavlje-16/',
      tags: ['rhizobium', 'simbiotski', 'ƒçvoriƒái', 'leguminoze', 'du≈°ik']
    },
    {
      id: 'poglavlje-17',
      naslov: 'Amilolitiƒçke bakterije',
      sadrzaj: 'Razgradnja ≈°kroba, amilaza enzim, Bacillus, jod test',
      tip: 'poglavlje',
      url: '/poglavlje-17/',
      tags: ['amilaza', '≈°krob', 'bacillus', 'jod', 'razgradnja']
    },
    {
      id: 'poglavlje-18',
      naslov: 'Proteolitiƒçke bakterije',
      sadrzaj: 'Razgradnja proteina, ≈æelatina, kazein, proteaze enzimi',
      tip: 'poglavlje',
      url: '/poglavlje-18/',
      tags: ['proteolitiƒçke', 'proteini', '≈æelatina', 'kazein', 'proteaze']
    },
    {
      id: 'poglavlje-19',
      naslov: 'Sulfat-reducirajuƒáe bakterije',
      sadrzaj: 'Redukcija sulfata, anaerobne bakterije, sumporovodik, biogeokemijski ciklus',
      tip: 'poglavlje',
      url: '/poglavlje-19/',
      tags: ['sulfat', 'redukcija', 'anaerobne', 'sumporovodik', 'ciklus']
    },
    {
      id: 'poglavlje-20',
      naslov: 'Nitrifikatorne bakterije',
      sadrzaj: 'Nitrifikacija, amonijak, nitrit, nitrat, kemolitotrofi',
      tip: 'poglavlje',
      url: '/poglavlje-20/',
      tags: ['nitrifikacija', 'amonijak', 'nitrit', 'nitrat', 'kemolitotrofi']
    },
    {
      id: 'poglavlje-21',
      naslov: 'Denitrifikatorne bakterije',
      sadrzaj: 'Denitrifikacija, nitrat redukcija, anaerobni procesi, du≈°ikov ciklus',
      tip: 'poglavlje',
      url: '/poglavlje-21/',
      tags: ['denitrifikacija', 'nitrat', 'anaerobni', 'du≈°ik', 'ciklus']
    },
    {
      id: 'poglavlje-22',
      naslov: 'Streptomiceti',
      sadrzaj: 'Actinomycetes, antibiotici, micelij, Czapekova podloga, razgradnja celuloze',
      tip: 'poglavlje',
      url: '/poglavlje-22/',
      tags: ['streptomiceti', 'antibiotici', 'micelij', 'czapek', 'celuloza']
    },
    {
      id: 'poglavlje-23',
      naslov: 'Fototrofne bakterije',
      sadrzaj: 'Fototrofija, purpurne bakterije, zelene bakterije, fotosinteza, Winogradsky',
      tip: 'poglavlje',
      url: '/poglavlje-23/',
      tags: ['fototrofne', 'purpurne', 'zelene', 'fotosinteza', 'winogradsky']
    }
  ],
  vjezbe: [
    {
      id: 'vjezba-1',
      naslov: 'Vje≈æbe iz aseptike i sterilizacije',
      sadrzaj: 'Autoklaviranje, suha sterilizacija, aseptiƒçni rad, kontrola sterilnosti',
      tip: 'vje≈æba',
      url: '/poglavlje-1/vjezba-1/',
      tags: ['aseptika', 'sterilizacija', 'autoklaviranje', 'kontrola']
    },
    {
      id: 'vjezba-2',
      naslov: 'Vje≈æbe bojenja bakterija',
      sadrzaj: 'Gram bojenje, bojenje endospora, negativno bojenje, mikroskopija',
      tip: 'vje≈æba',
      url: '/poglavlje-2/vjezba-2/',
      tags: ['bojenje', 'gram', 'endospore', 'mikroskopija']
    },
    {
      id: 'vjezba-22',
      naslov: 'Vje≈æbe s aktinomicetima',
      sadrzaj: 'Izolacija streptomiceta, testiranje antibiotika, micelijski rast',
      tip: 'vje≈æba', 
      url: '/poglavlje-22/vjezba-22/',
      tags: ['aktinomiceti', 'antibiotici', 'streptomiceti', 'izolacija']
    },
    {
      id: 'vjezba-23',
      naslov: 'Vje≈æbe s fototrofnim bakterijama',
      sadrzaj: 'Winogradsky stupci, anaerobna fototrofija, purpurne bakterije',
      tip: 'vje≈æba',
      url: '/poglavlje-23/vjezba-23/',
      tags: ['fototrofne', 'winogradsky', 'anaerobne', 'purpurne']
    }
  ],
  pojmovi: [
    {
      id: 'agar',
      naslov: 'Agar',
      sadrzaj: 'Gel substanca iz algi za ƒçvrste podloge, sterilizacija, priprava medija',
      tip: 'pojam',
      url: '/pojmovnik/#A',
      tags: ['agar', 'podloge', 'gel', 'medij']
    },
    {
      id: 'aseptika',
      naslov: 'Aseptika',
      sadrzaj: 'Postupci rada koji sprjeƒçavaju kontaminaciju, sterilnost, ƒçistoƒáa',
      tip: 'pojam',
      url: '/pojmovnik/#A',
      tags: ['aseptika', 'sterilnost', 'kontaminacija', 'ƒçistoƒáa']
    },
    {
      id: 'gram-bojenje',
      naslov: 'Gram bojenje',
      sadrzaj: 'Osnovno diferencijalno bojenje, gram pozitivne i negativne bakterije',
      tip: 'pojam',
      url: '/pojmovnik/#B',
      tags: ['gram', 'bojenje', 'diferencijalno', 'pozitivne', 'negativne']
    },
    {
      id: 'cfu',
      naslov: 'CFU (Colony Forming Unit)',
      sadrzaj: 'Jedinica brojanja bakterija, broj kolonija, kvantitativna mikrobiologija',
      tip: 'pojam',
      url: '/pojmovnik/#C',
      tags: ['cfu', 'brojanje', 'kolonije', 'kvantitativno']
    },
    {
      id: 'e-coli',
      naslov: 'E. coli (Escherichia coli)',
      sadrzaj: 'Gram negativna bakterija, indikator fekalnog zagaƒëenja, analiza vode',
      tip: 'pojam',
      url: '/pojmovnik/#E',
      tags: ['e.coli', 'escherichia', 'gram negativne', 'voda', 'fekalno']
    }
  ],
  kvizovi: [
    {
      id: 'kviz-opci',
      naslov: 'Opƒái kviz iz bakteriologije',
      sadrzaj: '24 pitanja iz svih poglavlja, sterilizacija, bojenje, identifikacija',
      tip: 'kviz',
      url: '/provjeri-znanje/',
      tags: ['kviz', 'test', 'pitanja', 'provjera', 'znanje']
    },
    {
      id: 'kviz-1',
      naslov: 'Kviz: Uvod u bakteriolo≈°ki praktikum',
      sadrzaj: 'Pitanja o aseptici, sterilizaciji, sigurnosti rada',
      tip: 'kviz',
      url: '/poglavlje-1/quiz-1/',
      tags: ['kviz', 'aseptika', 'sterilizacija', 'sigurnost']
    },
    {
      id: 'kviz-2',
      naslov: 'Kviz: Bojenje bakterija',
      sadrzaj: 'Pitanja o Gram bojenju, endosporama, kapsulaama',
      tip: 'kviz',
      url: '/poglavlje-2/quiz-2/',
      tags: ['kviz', 'bojenje', 'gram', 'endospore', 'kapsule']
    }
  ]
};

// Funkcija za pretragu
function searchContent(query: string) {
  const results: any[] = [];
  const searchTerm = query.toLowerCase().trim();
  
  if (!searchTerm) return results;

  // Pretra≈æuj kroz sve kategorije
  Object.values(searchIndex).flat().forEach(item => {
    const titleMatch = item.naslov.toLowerCase().includes(searchTerm);
    const contentMatch = item.sadrzaj.toLowerCase().includes(searchTerm);
    const tagMatch = item.tags.some((tag: string) => tag.toLowerCase().includes(searchTerm));
    
    if (titleMatch || contentMatch || tagMatch) {
      let relevance = 0;
      if (titleMatch) relevance += 3;
      if (contentMatch) relevance += 2; 
      if (tagMatch) relevance += 1;
      
      results.push({
        ...item,
        relevance,
        highlightedTitle: highlightText(item.naslov, searchTerm),
        highlightedContent: highlightText(item.sadrzaj, searchTerm)
      });
    }
  });
  
  // Sortiraj po relevantnosti
  return results.sort((a, b) => b.relevance - a.relevance);
}

function highlightText(text: string, searchTerm: string) {
  const regex = new RegExp(`(${searchTerm})`, 'gi');
  return text.replace(regex, '<mark class="bg-yellow-200 px-1 rounded">$1</mark>');
}
---

<!doctype html>
<html lang="hr" class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="generator" content={Astro.generator} />
    <title>{title}</title>
    <meta name="description" content={description} />
  </head>
  <body class="bg-page font-sans text-page">
    
    <!-- Navigation -->
    <nav class="bg-white shadow-sm border-b border-gray-100 sticky top-0 z-50">
      <div class="max-w-7xl mx-auto px-4 sm:px-6">
        <div class="flex justify-between items-center py-4">
          <a href="/" class="text-xl font-bold text-blue-600 hover:text-blue-700 transition-colors duration-300">
            Bakteriologija
          </a>
          
          <!-- Breadcrumb -->
          <nav class="hidden md:flex" aria-label="Breadcrumb">
            <ol class="flex items-center space-x-2 text-sm text-gray-500">
              <li><a href="/" class="hover:text-blue-600 transition-colors duration-300">Poƒçetna</a></li>
              <li class="text-gray-400">/</li>
              <li class="text-gray-900 font-medium">Pretraga</li>
            </ol>
          </nav>
          
          <!-- Back to content -->
          <a href="/sadrzaj/" class="inline-flex items-center text-blue-600 hover:text-blue-700 transition-colors duration-300 font-medium">
            <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
            </svg>
            Sadr≈æaj
          </a>
        </div>
      </div>
    </nav>

    <!-- Header -->
    <section class="bg-gradient-to-r from-blue-600 to-purple-600 text-white py-16">
      <div class="max-w-4xl mx-auto px-4 sm:px-6 text-center">
        <div class="w-16 h-16 bg-white/20 rounded-full flex items-center justify-center mx-auto mb-6">
          <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
          </svg>
        </div>
        <h1 class="text-4xl md:text-5xl font-bold mb-4">Pretraga</h1>
        <p class="text-xl md:text-2xl opacity-90 max-w-3xl mx-auto">
          Pronaƒëite sve ≈°to trebate kroz cijeli ud≈æbenik
        </p>
      </div>
    </section>

    <!-- Search Section -->
    <section class="py-12 bg-gray-50">
      <div class="max-w-4xl mx-auto px-4 sm:px-6">
        <div class="bg-white rounded-xl shadow-lg p-8">
          <!-- Search Input -->
          <div class="relative mb-6">
            <input
              type="text"
              id="mainSearchInput"
              placeholder="Pretra≈æite poglavlja, vje≈æbe, pojmove, kvizove..."
              class="w-full px-6 py-4 pl-14 pr-6 text-lg border-2 border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
            />
            <svg class="absolute left-5 top-5 w-6 h-6 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
            </svg>
          </div>

          <!-- Search Filters -->
          <div class="flex flex-wrap gap-3 mb-8">
            <button class="filter-btn active" data-filter="all">
              <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path>
              </svg>
              Sve
            </button>
            <button class="filter-btn" data-filter="poglavlje">
              <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
              </svg>
              Poglavlja
            </button>
            <button class="filter-btn" data-filter="vje≈æba">
              <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
              </svg>
              Vje≈æbe
            </button>
            <button class="filter-btn" data-filter="pojam">
              <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16l2.879-2.879m0 0a3 3 0 104.243-4.242 3 3 0 00-4.243 4.242zM21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
              Pojmovi
            </button>
            <button class="filter-btn" data-filter="kviz">
              <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
              Kvizovi
            </button>
          </div>

          <!-- Search Results -->
          <div id="searchResults" class="space-y-6">
            <!-- Poƒçetno stanje - preporuƒçeni sadr≈æaj -->
            <div id="initialContent">
              <h3 class="text-xl font-semibold text-gray-900 mb-6">üî• Popularan sadr≈æaj</h3>
              <div class="grid gap-4">
                <a href="/pojmovnik/" class="block p-6 bg-gray-50 rounded-lg hover:shadow-md transition-all duration-300">
                  <div class="flex items-start">
                    <div class="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center mr-4 flex-shrink-0">
                      <svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
                      </svg>
                    </div>
                    <div>
                      <h4 class="font-semibold text-gray-900 mb-2">Pojmovnik</h4>
                      <p class="text-gray-600">Rjeƒçnik svih bakteriolo≈°kih pojmova</p>
                    </div>
                  </div>
                </a>
                
                <a href="/provjeri-znanje/" class="block p-6 bg-gray-50 rounded-lg hover:shadow-md transition-all duration-300">
                  <div class="flex items-start">
                    <div class="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center mr-4 flex-shrink-0">
                      <svg class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                      </svg>
                    </div>
                    <div>
                      <h4 class="font-semibold text-gray-900 mb-2">Provjeri znanje</h4>
                      <p class="text-gray-600">Opƒái kviz s 24 pitanja iz svih poglavlja</p>
                    </div>
                  </div>
                </a>
                
                <a href="/poglavlje-1/" class="block p-6 bg-gray-50 rounded-lg hover:shadow-md transition-all duration-300">
                  <div class="flex items-start">
                    <div class="w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center mr-4 flex-shrink-0">
                      <svg class="w-5 h-5 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
                      </svg>
                    </div>
                    <div>
                      <h4 class="font-semibold text-gray-900 mb-2">Uvod u bakteriolo≈°ki praktikum</h4>
                      <p class="text-gray-600">Poƒçnite ovdje - aseptika i osnove rada</p>
                    </div>
                  </div>
                </a>
              </div>
            </div>

            <!-- Rezultati pretrage -->
            <div id="resultsContainer" class="hidden">
              <div id="resultsHeader" class="flex items-center justify-between mb-6">
                <h3 id="resultsCount" class="text-xl font-semibold text-gray-900"></h3>
                <button id="clearSearch" class="text-blue-600 hover:text-blue-800 transition-colors duration-300">
                  Obri≈°i pretragu
                </button>
              </div>
              <div id="resultsList" class="space-y-4"></div>
            </div>

            <!-- Nema rezultata -->
            <div id="noResults" class="hidden text-center py-12">
              <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4">
                <svg class="w-8 h-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                </svg>
              </div>
              <h3 class="text-lg font-semibold text-gray-900 mb-2">Nema rezultata</h3>
              <p class="text-gray-600 mb-4">Poku≈°ajte s drugim pojmom ili provjerite pravopis</p>
              <div class="text-sm text-gray-500">
                <p>Savjeti za pretragu:</p>
                <ul class="mt-2 space-y-1">
                  <li>‚Ä¢ Koristite kratke kljuƒçne rijeƒçi</li>
                  <li>‚Ä¢ Poku≈°ajte s sinonimima</li>
                  <li>‚Ä¢ Provjerite pravopis</li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Quick Links -->
    <section class="py-16 bg-white">
      <div class="max-w-6xl mx-auto px-4 sm:px-6">
        <h2 class="text-2xl font-bold text-gray-900 text-center mb-8">Brzi pristup</h2>
        <div class="grid md:grid-cols-4 gap-6">
          <a href="/sadrzaj/" class="p-6 bg-gray-50 rounded-xl hover:shadow-lg transition-all duration-300 transform hover:-translate-y-1">
            <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
              <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
              </svg>
            </div>
            <h3 class="text-lg font-semibold text-gray-900 mb-2 text-center">Sadr≈æaj</h3>
            <p class="text-gray-600 text-center">Pregled svih poglavlja</p>
          </a>
          
          <a href="/pojmovnik/" class="p-6 bg-gray-50 rounded-xl hover:shadow-lg transition-all duration-300 transform hover:-translate-y-1">
            <div class="w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4">
              <svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
              </svg>
            </div>
            <h3 class="text-lg font-semibold text-gray-900 mb-2 text-center">Pojmovnik</h3>
            <p class="text-gray-600 text-center">Rjeƒçnik pojmova</p>
          </a>
          
          <a href="/provjeri-znanje/" class="p-6 bg-gray-50 rounded-xl hover:shadow-lg transition-all duration-300 transform hover:-translate-y-1">
            <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
              <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
            </div>
            <h3 class="text-lg font-semibold text-gray-900 mb-2 text-center">Kviz</h3>
            <p class="text-gray-600 text-center">Testiraj znanje</p>
          </a>
          
          <a href="/" class="p-6 bg-gray-50 rounded-xl hover:shadow-lg transition-all duration-300 transform hover:-translate-y-1">
            <div class="w-12 h-12 bg-orange-100 rounded-full flex items-center justify-center mx-auto mb-4">
              <svg class="w-6 h-6 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>
              </svg>
            </div>
            <h3 class="text-lg font-semibold text-gray-900 mb-2 text-center">Poƒçetna</h3>
            <p class="text-gray-600 text-center">Povratak na poƒçetnu</p>
          </a>
        </div>
      </div>
    </section>

    <!-- JavaScript for Search -->
    <script define:vars={{ searchIndex }}>
      // Search index je dostupan kao globalna varijabla
      let currentFilter = 'all';
      let currentResults = [];

      // CSS stilovi za filtere
      const style = document.createElement('style');
      style.textContent = `
        .filter-btn {
          display: inline-flex;
          align-items: center;
          padding: 0.5rem 1rem;
          background: white;
          border: 2px solid #e5e7eb;
          border-radius: 0.75rem;
          font-weight: 500;
          color: #6b7280;
          transition: all 0.3s;
          cursor: pointer;
        }
        .filter-btn:hover {
          border-color: #3b82f6;
          color: #3b82f6;
        }
        .filter-btn.active {
          background: #3b82f6;
          border-color: #3b82f6;
          color: white;
        }
      `;
      document.head.appendChild(style);

      function searchContent(query) {
        const results = [];
        const searchTerm = query.toLowerCase().trim();
        
        if (!searchTerm) return results;

        // Pretra≈æuj kroz sve kategorije
        Object.values(searchIndex).flat().forEach(item => {
          // Primijeni filter
          if (currentFilter !== 'all' && item.tip !== currentFilter) {
            return;
          }

          const titleMatch = item.naslov.toLowerCase().includes(searchTerm);
          const contentMatch = item.sadrzaj.toLowerCase().includes(searchTerm);
          const tagMatch = item.tags.some(tag => tag.toLowerCase().includes(searchTerm));
          
          if (titleMatch || contentMatch || tagMatch) {
            let relevance = 0;
            if (titleMatch) relevance += 3;
            if (contentMatch) relevance += 2; 
            if (tagMatch) relevance += 1;
            
            results.push({
              ...item,
              relevance,
              highlightedTitle: highlightText(item.naslov, searchTerm),
              highlightedContent: highlightText(item.sadrzaj, searchTerm)
            });
          }
        });
        
        // Sortiraj po relevantnosti
        return results.sort((a, b) => b.relevance - a.relevance);
      }

      function highlightText(text, searchTerm) {
        const regex = new RegExp(`(${searchTerm})`, 'gi');
        return text.replace(regex, '<mark class="bg-yellow-200 px-1 rounded">$1</mark>');
      }

      function getTypeIcon(tip) {
        switch(tip) {
          case 'poglavlje':
            return `<svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
            </svg>`;
          case 'vje≈æba':
            return `<svg class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
            </svg>`;
          case 'pojam':
            return `<svg class="w-5 h-5 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16l2.879-2.879m0 0a3 3 0 104.243-4.242 3 3 0 00-4.243 4.242zM21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>`;
          case 'kviz':
            return `<svg class="w-5 h-5 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>`;
          default:
            return `<svg class="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
            </svg>`;
        }
      }

      function getTypeBadge(tip) {
        const types = {
          'poglavlje': { label: 'Poglavlje', class: 'bg-blue-100 text-blue-800' },
          'vje≈æba': { label: 'Vje≈æba', class: 'bg-green-100 text-green-800' },
          'pojam': { label: 'Pojam', class: 'bg-purple-100 text-purple-800' },
          'kviz': { label: 'Kviz', class: 'bg-orange-100 text-orange-800' }
        };
        
        const type = types[tip] || { label: tip, class: 'bg-gray-100 text-gray-800' };
        return `<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${type.class}">${type.label}</span>`;
      }

      function displayResults(results) {
        const initialContent = document.getElementById('initialContent');
        const resultsContainer = document.getElementById('resultsContainer');
        const noResults = document.getElementById('noResults');
        const resultsCount = document.getElementById('resultsCount');
        const resultsList = document.getElementById('resultsList');

        // Sakrij poƒçetni sadr≈æaj
        initialContent.classList.add('hidden');

        if (results.length === 0) {
          resultsContainer.classList.add('hidden');
          noResults.classList.remove('hidden');
          return;
        }

        // Prika≈æi rezultate
        noResults.classList.add('hidden');
        resultsContainer.classList.remove('hidden');
        
        resultsCount.textContent = `${results.length} rezultat${results.length === 1 ? '' : results.length < 5 ? 'a' : 'a'}`;
        
        resultsList.innerHTML = results.map(result => `
          <a href="${result.url}" class="block p-6 bg-white border border-gray-200 rounded-lg hover:shadow-md transition-all duration-300">
            <div class="flex items-start">
              <div class="w-10 h-10 bg-gray-50 rounded-full flex items-center justify-center mr-4 flex-shrink-0">
                ${getTypeIcon(result.tip)}
              </div>
              <div class="flex-1 min-w-0">
                <div class="flex items-center justify-between mb-2">
                  <h4 class="font-semibold text-gray-900 text-lg">${result.highlightedTitle}</h4>
                  ${getTypeBadge(result.tip)}
                </div>
                <p class="text-gray-600 mb-3">${result.highlightedContent}</p>
                <div class="flex items-center text-sm text-gray-500">
                  <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-2M14 4h6m0 0v6m0-6L10 14"></path>
                  </svg>
                  Otvori ${result.tip}
                </div>
              </div>
            </div>
          </a>
        `).join('');

        currentResults = results;
      }

      function clearSearchResults() {
        document.getElementById('mainSearchInput').value = '';
        document.getElementById('initialContent').classList.remove('hidden');
        document.getElementById('resultsContainer').classList.add('hidden');
        document.getElementById('noResults').classList.add('hidden');
        currentResults = [];
      }

      // Event listeners
      document.addEventListener('DOMContentLoaded', function() {
        const searchInput = document.getElementById('mainSearchInput');
        const filterBtns = document.querySelectorAll('.filter-btn');
        const clearBtn = document.getElementById('clearSearch');

        // Search input
        searchInput.addEventListener('input', function() {
          const query = this.value.trim();
          if (query.length === 0) {
            clearSearchResults();
            return;
          }
          
          if (query.length >= 2) {
            const results = searchContent(query);
            displayResults(results);
          }
        });

        // Filter buttons
        filterBtns.forEach(btn => {
          btn.addEventListener('click', function() {
            // Update active filter
            filterBtns.forEach(b => b.classList.remove('active'));
            this.classList.add('active');
            currentFilter = this.dataset.filter;

            // Re-search with new filter
            const query = searchInput.value.trim();
            if (query.length >= 2) {
              const results = searchContent(query);
              displayResults(results);
            }
          });
        });

        // Clear search
        clearBtn.addEventListener('click', clearSearchResults);

        // Focus na search input
        searchInput.focus();
      });
    </script>

  </body>
</html>
