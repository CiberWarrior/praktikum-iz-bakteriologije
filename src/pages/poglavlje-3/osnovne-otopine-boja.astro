---
import SubPageLayout from '../../components/SubPageLayout.astro';

export interface Props {
  title?: string;
  description?: string;
}

const { 
  title = 'Osnovne otopine boja',
  description = 'Tipovi boja i priprema otopina za bojenje bakterija'
} = Astro.props;
---

<SubPageLayout 
  title={title} 
  description={description}
  chapterNumber={3}
  primaryColor="red"
  breadcrumbPath={[
    { name: 'Poglavlje 3', url: '/poglavlje-3/' },
    { name: 'Osnovne otopine boja', url: '/poglavlje-3/osnovne-otopine-boja/' }
  ]}
>

  <!-- Main Content with Sidebar -->
  <div class="flex max-w-7xl mx-auto">
    
    <!-- Table of Contents Sidebar -->
    <aside class="hidden lg:block w-64 p-6 bg-gradient-to-b from-gray-50 to-gray-100 border-r border-gray-200 sticky top-0 h-screen overflow-y-auto shadow-lg">
      <div class="mb-6">
        <div class="flex items-center mb-6">
          <div class="w-8 h-8 bg-red-600 rounded-lg flex items-center justify-center mr-3">
            <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
            </svg>
          </div>
          <h3 class="text-xl font-bold text-gray-900">Sadržaj stranice</h3>
        </div>
        
        <!-- Bookmark Button -->
        <button id="bookmark-btn" class="flex items-center space-x-3 text-sm text-gray-600 hover:text-red-600 transition-all duration-300 mb-6 p-3 rounded-lg hover:bg-red-50 w-full">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"></path>
          </svg>
          <span id="bookmark-text" class="font-medium">Označiti kao bookmark</span>
        </button>
        
        <!-- Table of Contents -->
        <nav class="space-y-1">
          <div class="text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2">Sadržaj stranice</div>
          <a href="#osnovne-otopine-boja" class="toc-link group flex items-center text-sm text-gray-600 hover:text-red-600 transition-all duration-300 py-2 px-3 rounded-lg hover:bg-red-50" data-target="osnovne-otopine-boja">
            <span class="w-2 h-2 bg-blue-400 rounded-full mr-3 transition-all duration-300"></span>
            Osnovne otopine boja
          </a>
        </nav>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 px-6 py-8">
      <div class="max-w-4xl mx-auto">
        <div class="prose prose-lg max-w-none">
          
          <!-- Content Blocks -->
          <div class="space-y-8">
            
            <!-- Osnovne otopine boja -->
            <div id="osnovne-otopine-boja" class="bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-6 shadow-lg border border-blue-200">
              <div class="flex items-center mb-4">
                <div class="w-10 h-10 bg-orange-600 rounded-lg flex items-center justify-center mr-4">
                  <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                  </svg>
                </div>
                <h3 class="text-2xl font-bold text-blue-900">Osnovne otopine boja</h3>
              </div>
              
              <div class="bg-white rounded-lg p-4 shadow-sm">
                <p class="text-gray-700 leading-relaxed">
                  U bakteriologiji se upotrebljavaju dva tipa boja: kisela (kationska) i bazična (anionska). Boje imaju tu sposobnost da se vežu na razne komponente bakterijske stanice (proteine, nukleinske kiseline), što ovisi o električnom naboju staničnih sastojaka te o kromogenom dijelu samog bojila. Za postupak bojenja moraju se iz zasićenih otopina pripremljenih bojila pripraviti određena razrjeđenja koja imaju kraći vijek trajanja (nekoliko dana do nekoliko mjeseci). Pri bojenju bakterija potrebno je da boje budu svježe. Čuvane u smeđim bočicama mogu biti za upotrebu dulje vrijeme.
                </p>
              </div>
            </div>

          </div>

        </div>
      </div>
    </main>
  </div>

  <!-- Mobile TOC Toggle -->
  <button id="mobile-toc-toggle" class="lg:hidden fixed bottom-4 right-4 bg-red-600 text-white p-3 rounded-full shadow-lg z-50">
    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7"></path>
    </svg>
  </button>

  <!-- Mobile TOC Overlay -->
  <div id="mobile-toc-overlay" class="lg:hidden fixed inset-0 bg-black bg-opacity-50 z-40 hidden">
    <div class="fixed right-0 top-0 h-full w-80 bg-white shadow-xl transform translate-x-full transition-transform duration-300" id="mobile-toc-panel">
      <div class="p-6">
        <div class="flex justify-between items-center mb-6">
          <h3 class="text-lg font-semibold text-gray-900">Brza navigacija</h3>
          <button id="mobile-toc-close" class="text-gray-500 hover:text-gray-700">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </button>
        </div>
        
        <!-- Bookmark Button -->
        <button id="mobile-bookmark-btn" class="flex items-center space-x-2 text-sm text-gray-600 hover:text-red-600 transition-colors duration-200 mb-4 w-full">
          <svg id="mobile-bookmark-icon" class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"></path>
          </svg>
          <span id="mobile-bookmark-text">Označiti kao bookmark</span>
        </button>
        
        <!-- Navigation Links -->
        <nav class="space-y-2">
          <a href="/poglavlje-3/" class="mobile-toc-link block text-sm text-gray-600 hover:text-red-600 transition-colors duration-200 py-2 border-l-2 border-transparent hover:border-red-600 pl-3">
            Pregled poglavlja
          </a>
          <a href="/sadrzaj/" class="mobile-toc-link block text-sm text-gray-600 hover:text-red-600 transition-colors duration-200 py-2 border-l-2 border-transparent hover:border-red-600 pl-3">
            Svi sadržaji
          </a>
        </nav>
      </div>
    </div>
  </div>

  <!-- CSS Styles for Active State -->
  <style>
    .toc-link.active {
      @apply text-red-600 bg-red-50 font-semibold;
    }
    
    .toc-link.active span {
      @apply w-3 h-3 scale-125;
    }
  </style>

  <!-- JavaScript -->
  <script>
    // Bookmark functionality
    function initBookmarks() {
      const bookmarkKey = 'bookmark-osnovne-otopine-boja';
      const bookmarkBtn = document.getElementById('bookmark-btn');
      const bookmarkIcon = document.getElementById('bookmark-icon');
      const bookmarkText = document.getElementById('bookmark-text');
      const mobileBookmarkBtn = document.getElementById('mobile-bookmark-btn');
      const mobileBookmarkIcon = document.getElementById('mobile-bookmark-icon');
      const mobileBookmarkText = document.getElementById('mobile-bookmark-text');
      
      // Check if bookmarked
      const isBookmarked = localStorage.getItem(bookmarkKey) === 'true';
      updateBookmarkUI(isBookmarked);
      
      function updateBookmarkUI(bookmarked: boolean) {
        const fillAttribute = bookmarked ? 'currentColor' : 'none';
        const text = bookmarked ? 'Ukloniti bookmark' : 'Označiti kao bookmark';
        
        if (bookmarkIcon) bookmarkIcon.setAttribute('fill', fillAttribute);
        if (bookmarkText) bookmarkText.textContent = text;
        if (mobileBookmarkIcon) mobileBookmarkIcon.setAttribute('fill', fillAttribute);
        if (mobileBookmarkText) mobileBookmarkText.textContent = text;
      }
      
      function toggleBookmark() {
        const currentlyBookmarked = localStorage.getItem(bookmarkKey) === 'true';
        const newBookmarkState = !currentlyBookmarked;
        localStorage.setItem(bookmarkKey, newBookmarkState.toString());
        updateBookmarkUI(newBookmarkState);
      }
      
      if (bookmarkBtn) bookmarkBtn.addEventListener('click', toggleBookmark);
      if (mobileBookmarkBtn) mobileBookmarkBtn.addEventListener('click', toggleBookmark);
    }

    // Mobile TOC
    function initMobileTOC() {
      const toggleBtn = document.getElementById('mobile-toc-toggle');
      const overlay = document.getElementById('mobile-toc-overlay');
      const panel = document.getElementById('mobile-toc-panel');
      const closeBtn = document.getElementById('mobile-toc-close');
      const tocLinks = document.querySelectorAll('.mobile-toc-link');
      
      function openTOC() {
        if (overlay && panel) {
          overlay.classList.remove('hidden');
          setTimeout(() => {
            panel.classList.remove('translate-x-full');
          }, 10);
        }
      }
      
      function closeTOC() {
        if (panel && overlay) {
          panel.classList.add('translate-x-full');
          setTimeout(() => {
            overlay.classList.add('hidden');
          }, 300);
        }
      }
      
      if (toggleBtn) toggleBtn.addEventListener('click', openTOC);
      if (closeBtn) closeBtn.addEventListener('click', closeTOC);
      if (overlay) {
        overlay.addEventListener('click', (e) => {
          if (e.target === overlay) closeTOC();
        });
      }
      
      // Close TOC when clicking on a link
      tocLinks.forEach(link => {
        link.addEventListener('click', closeTOC);
      });
    }

    // Scroll Spy for TOC
    function initScrollSpy() {
      const sections = document.querySelectorAll('[id^="osnovne-"]');
      const tocLinks = document.querySelectorAll('.toc-link');
      
      function updateActiveLink() {
        let currentSection = '';
        
        sections.forEach(section => {
          const rect = section.getBoundingClientRect();
          if (rect.top <= 100 && rect.bottom >= 100) {
            currentSection = section.id;
          }
        });
        
        // Remove active class from all links
        tocLinks.forEach(link => {
          link.classList.remove('active');
        });
        
        // Add active class to current section link
        if (currentSection) {
          const activeLink = document.querySelector(`[data-target="${currentSection}"]`);
          if (activeLink) {
            activeLink.classList.add('active');
          }
        }
      }
      
      // Listen for scroll events
      window.addEventListener('scroll', updateActiveLink);
      
      // Initial check
      updateActiveLink();
    }

    // Initialize everything
    document.addEventListener('DOMContentLoaded', () => {
      initBookmarks();
      initMobileTOC();
      initScrollSpy();
    });
  </script>

  <!-- Navigacijski gumbovi -->
  <div class="flex justify-between mt-16 mb-8 max-w-4xl mx-auto px-4 sm:px-6">
    <!-- Prethodna stranica -->
    <a
      href="/poglavlje-3/metode-bojenja-bakterija/"
      class="inline-flex items-center justify-center px-8 py-4 bg-gradient-to-r from-gray-600 to-gray-700 text-white font-semibold rounded-full shadow-lg hover:shadow-xl transition-all duration-300 no-underline transform hover:-translate-y-1"
      aria-label="Prijeđi na prethodnu stranicu: metode bojenja bakterija"
    >
      ←
      <span class="text-lg">metode bojenja bakterija</span>
    </a>
    
    <!-- Iduća stranica -->
    <a
      href="/poglavlje-3/jednostavna-bojenja/"
      class="inline-flex items-center justify-center px-8 py-4 bg-gradient-to-r from-red-600 to-red-700 text-white font-semibold rounded-full shadow-lg hover:shadow-xl transition-all duration-300 no-underline transform hover:-translate-y-1"
      aria-label="Prijeđi na sljedeću stranicu: jednostavna bojenja"
    >
      <span class="text-lg">jednostavna bojenja</span>
      →
    </a>
  </div>

</SubPageLayout>
